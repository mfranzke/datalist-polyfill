/*
* Datalist polyfill - https://github.com/mfranzke/datalist-polyfill
* @license Copyright(c) 2017 by Maximilian Franzke
* Supported by Christian, Johannes, @mitchhentges, @mertenhanisch, @ailintom, @Kravimir, @mischah, @hryamzik, @ottoville, @IceCreamYou, @wlekin, @eddr, @beebee1987 and @mricherzhagen - many thanks for that !
*/
!function(){"use strict";var e=window.document;if("list"in e.createElement("input")&&Boolean(e.createElement("datalist")&&window.HTMLDataListElement))return!1;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector);var t=!1,i=13,n=27,r=38,a=40,l=" / ",o=["text","email","number","search","tel","url"],s="polyfilled",u="polyfilling";window.addEventListener("touchstart",function e(){t=!0,window.removeEventListener("touchstart",e)});var d=window.MutationObserver||window.WebKitMutationObserver,p;void 0!==d&&(p=new d(function(t){var i=!1;if(t.forEach(function(e){for(var t=0;t<e.addedNodes.length;++t)"datalist"===e.target.tagName.toLowerCase()&&(i=e.target)}),i){var n=e.querySelector('input[list="'+i.id+'"]');""!==n.value&&w(f(i,n).length,i.getElementsByClassName("polyfilling")[0])}}));var c=function(e){var i=e.target,n=i.list,r=n.getElementsByClassName("polyfilling")[0]||g(i,n);if("input"===i.tagName.toLowerCase()&&null!==n&&void 0!==r){var a=!1,l=38===e.keyCode||40===e.keyCode;if(27!==e.keyCode&&13!==e.keyCode&&(""!==i.value||l)){f(n,i).length>0&&(a=!0);var o=0,s=r.options.length-1;t?r.selectedIndex=0:l&&"number"!==i.getAttribute("type")&&(r.selectedIndex=38===e.keyCode?s:0,r.focus())}w(a,r)}},y=function(e,t){var i=e.value.toLowerCase(),n=t.toLowerCase(),r=e.getAttribute("label"),a=e.text.toLowerCase();return Boolean(!1===e.disabled&&(""!==i&&-1!==i.indexOf(n)||r&&-1!==r.toLowerCase().indexOf(n)||""!==a&&-1!==a.indexOf(n)))},v=function(e){if(e.target.matches("input[list]")){var t=e.target,i=t.list;if("input"===t.tagName.toLowerCase()&&null!==i){var n=i.getElementsByClassName("polyfilling")[0]||g(t,i),r=n&&n.querySelector("option:not(:disabled)")&&("focusin"===e.type&&""!==t.value||e.relatedTarget&&e.relatedTarget===n);t.matches(".polyfilled")||(t.setAttribute("autocomplete","off"),t.setAttribute("role","textbox"),t.setAttribute("aria-haspopup","true"),t.setAttribute("aria-autocomplete","list"),t.setAttribute("aria-owns",t.getAttribute("list")),"focusin"===e.type?(t.addEventListener("keyup",c),t.addEventListener("focusout",v,!0)):"blur"===e.type&&(t.removeEventListener("keyup",c),t.removeEventListener("focusout",v,!0)),t.className+=" polyfilled"),w(r,n)}}};e.addEventListener("focusin",v,!0);var f=function(i,n){void 0!==p&&p.disconnect();var r=i.getElementsByClassName("polyfilling")[0]||g(n,i),a=n.value,l=e.createDocumentFragment(),o=e.createDocumentFragment();"email"===n.getAttribute("type")&&null!==n.getAttribute("multiple")&&(a=a.substring(a.lastIndexOf(",")+1)),Array.prototype.slice.call(i.querySelectorAll("option:not(:disabled)")).sort(function(e,t){var i=e.value,r=t.value;return"url"===n.getAttribute("type")&&(i=i.replace(/(^\w+:|^)\/\//,""),r=r.replace(/(^\w+:|^)\/\//,"")),i.localeCompare(r)}).forEach(function(e){var t=e.value,i=e.getAttribute("label"),n=e.text;if(y(e,a)){var r=n.substr(0,t.length+" / ".length),s=t+" / ";n&&!i&&n!==t&&r!==s?e.innerText=t+" / "+n:e.text||(e.innerText=i||t),l.appendChild(e)}else o.appendChild(e)}),r.appendChild(l);var s=r.options.length;return r.size=s>10?10:s,r.multiple=!t&&s<2,(i.getElementsByClassName("ie9_fix")[0]||i).appendChild(o),void 0!==p&&p.observe(i,{childList:!0}),r.options},g=function(i,n){if(-1!==o.indexOf(i.getAttribute("type"))&&null!==n){var r=i.getClientRects(),a=window.getComputedStyle(i),l=e.createElement("select");if(l.setAttribute("class","polyfilling"),l.style.position="absolute",w(!1,l),l.setAttribute("tabindex","-1"),l.setAttribute("aria-live","polite"),l.setAttribute("role","listbox"),t||l.setAttribute("aria-multiselectable","false"),"block"===a.getPropertyValue("display"))l.style.marginTop="-"+a.getPropertyValue("margin-bottom");else{var s="rtl"===a.getPropertyValue("direction")?"right":"left";l.style.setProperty("margin-"+s,"-"+(r[0].width+parseFloat(a.getPropertyValue("margin-"+s)))+"px"),l.style.marginTop=parseInt(r[0].height+(i.offsetTop-n.offsetTop),10)+"px"}if(l.style.borderRadius=a.getPropertyValue("border-radius"),l.style.minWidth=r[0].width+"px",t){var u=e.createElement("option");u.innerText=n.title,u.disabled=!0,u.setAttribute("class","message"),l.appendChild(u)}return n.appendChild(l),t?l.addEventListener("change",b):l.addEventListener("click",b),l.addEventListener("blur",b),l.addEventListener("keydown",b),l.addEventListener("keypress",m),l}},m=function(t){var i=t.target,n=i.parentNode,r=e.querySelector('input[list="'+n.id+'"]');"select"===i.tagName.toLowerCase()&&null!==r&&(!t.key||"Backspace"!==t.key&&1!==t.key.length||(r.focus(),"Backspace"===t.key?(r.value=r.value.substr(0,r.value.length-1),h(r)):r.value+=t.key,f(n,r)))},b=function(t){var i=t.currentTarget,n=i.parentNode,r=e.querySelector('input[list="'+n.id+'"]');if("select"===i.tagName.toLowerCase()&&null!==r){var a=t.type,l="keydown"===a&&13!==t.keyCode&&27!==t.keyCode;if(("change"===a||"click"===a||"keydown"===a&&(13===t.keyCode||"Tab"===t.key))&&i.value.length>0&&i.value!==n.title){var o;r.value="email"===r.getAttribute("type")&&null!==r.getAttribute("multiple")&&(o=r.value.lastIndexOf(","))>-1?r.value.slice(0,o)+","+i.value:r.value=i.value,h(r),"Tab"!==t.key&&r.focus(),l=!1}else"keydown"===a&&27===t.keyCode&&r.focus();w(l,i)}},h=function(t){var i;"function"==typeof Event?i=new Event("input",{bubbles:!0}):(i=e.createEvent("Event"),i.initEvent("input",!0,!1)),t.dispatchEvent(i)},w=function(t,i){t?i.removeAttribute("hidden"):i.setAttributeNode(e.createAttribute("hidden")),i.setAttribute("aria-hidden",(!t).toString())};!function(t){t&&t.prototype&&void 0===t.prototype.list&&Object.defineProperty(t.prototype,"list",{get:function(){var i=e.getElementById(this.getAttribute("list"));return"object"==typeof this&&this instanceof t&&i&&i.matches("datalist")?i:null}})}(window.HTMLInputElement),function(e){e&&e.prototype&&void 0===e.prototype.options&&Object.defineProperty(e.prototype,"options",{get:function(){return"object"==typeof this&&this instanceof e?this.getElementsByTagName("option"):null}})}(window.HTMLElement)}();